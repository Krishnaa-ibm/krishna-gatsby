"use strict";(self.webpackChunkexample=self.webpackChunkexample||[]).push([[1824],{7470:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return l},default:function(){return u}});var n=a(5987),r=(a(7294),a(4983)),i=a(4295);const o=["components"],l={},s=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)},m=s("PageDescription"),p=s("InlineNotification"),c={_frontmatter:l},d=i.Z;function u(e){let{components:t}=e,a=(0,n.Z)(e,o);return(0,r.kt)(d,Object.assign({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(m,{mdxType:"PageDescription"},(0,r.kt)("p",null,"Earlier this year, Gatsby released ",(0,r.kt)("inlineCode",{parentName:"p"},"v3")," of their library. This update introduces\nseveral big improvements to Gatsby sites including incremental builds, fast\nrefresh, and image processing. The major version change comes with the potential\nfor breaking changes, this guide aims to cover the most likely issues a site\nbuilt with the Carbon Gatsby theme might encounter.")),(0,r.kt)("h2",null,"Breaking Changes"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Bumped minimum version of Gatsby to ",(0,r.kt)("inlineCode",{parentName:"li"},"v3")),(0,r.kt)("li",{parentName:"ol"},"Removed the ",(0,r.kt)("inlineCode",{parentName:"li"},"emotion")," theme provider and its dependenices.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"This impacts sites styling their project using ",(0,r.kt)("inlineCode",{parentName:"li"},"emotion")," and depending on\ntheme values supplied by the theme"),(0,r.kt)("li",{parentName:"ul"},"If this applies to your project, you can recreate the theme’s emotion\nintegration installing ",(0,r.kt)("inlineCode",{parentName:"li"},"emotion")," and replicating the\n",(0,r.kt)("a",{parentName:"li",href:"https://github.com/carbon-design-system/gatsby-theme-carbon/blob/857abf691590d86b9384a8f35256e8f54fad299e/packages/gatsby-theme-carbon/src/components/ThemeProvider.js"},(0,r.kt)("inlineCode",{parentName:"a"},"ThemeProvider")),"\ncomponent and\n",(0,r.kt)("a",{parentName:"li",href:"https://github.com/carbon-design-system/gatsby-theme-carbon/blob/main/packages/gatsby-theme-carbon/src/util/theme.js"},(0,r.kt)("inlineCode",{parentName:"a"},"theme.js")),".\nFinally, you’ll want to shadow\n",(0,r.kt)("a",{parentName:"li",href:"https://github.com/carbon-design-system/gatsby-theme-carbon/blob/857abf691590d86b9384a8f35256e8f54fad299e/packages/gatsby-theme-carbon/src/util/wrap-root-element.js#L1"},(0,r.kt)("inlineCode",{parentName:"a"},"wrap-root-element.js")),"\nto add back the ",(0,r.kt)("inlineCode",{parentName:"li"},"ThemeProvider")," wrapper.")))),(0,r.kt)("h2",null,"Migration guide"),(0,r.kt)("p",null,"In this section we’ll cover the most likely issues site’s built with the Carbon\ngatsby theme might encounter when migrating. If you encounter any issues, or\nyour site leverages more advanced gatsby configuration, check to see if it’s\ncovered in the\n",(0,r.kt)("a",{parentName:"p",href:"https://www.gatsbyjs.com/docs/reference/release-notes/migrating-from-v2-to-v3/"},"official Gatsby v3 migration guide"),"."),(0,r.kt)(p,{mdxType:"InlineNotification"},(0,r.kt)("p",null,"Note: We’ll use yarn for the shell commands here. Replace them with the ",(0,r.kt)("inlineCode",{parentName:"p"},"npm"),"\nequivalent if your project uses ",(0,r.kt)("inlineCode",{parentName:"p"},"npm")," as its package manager.")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Update Gatsby"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"yarn add gatsby@latest\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Update gatsby plugins (including the theme)"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"yarn upgrade-interactive --latest\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Check to see if you’re using ",(0,r.kt)("inlineCode",{parentName:"p"},"sizes")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"resolutions")," with ",(0,r.kt)("inlineCode",{parentName:"p"},"gatsby-image"),". Do\na project wide search for ",(0,r.kt)("inlineCode",{parentName:"p"},"gatsby-image"),". Check to make sure that you’re not\nusing these\n",(0,r.kt)("a",{parentName:"p",href:"https://www.gatsbyjs.com/docs/reference/release-notes/migrating-from-v2-to-v3/#removal-of-sizes--resolutions-for-image-queries"},"deprecated props"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Check your Sass (and potentially JSON) to ensure they’re imported as ES\nModules. “Default exports” are no longer supported."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:"path=Before",path:"Before"},"import styles from './MySpan.module.scss';\nimport metadata from './metadata.json';\n\nconst MySpan = () => <span className={styles.mySpan} />;\n")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:"path=After",path:"After"},"import { mySpan } from './MySpan.module.scss';\n// Or import * as styles from './MySpan.module.scss'\n\nimport * as metadata from './metadata.json';\n\nconst MySpan = () => <span className={mySpan} />;\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Make sure to update the path of your shadowed components (Footer and Header). "),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Create a folder each for ",(0,r.kt)("inlineCode",{parentName:"li"},"Footer")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"Header"),"."),(0,r.kt)("li",{parentName:"ul"},"Change the file name to ",(0,r.kt)("inlineCode",{parentName:"li"},"index.js")," inside each corresponding folder. More info can be found in the ",(0,r.kt)("a",{parentName:"li",href:"https://gatsby-theme-carbon.vercel.app/guides/shadowing/#shadowing-basics"},"shadowing docs")))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"If you have a custom webpack config, be sure your config is compatible with ",(0,r.kt)("a",{parentName:"p",href:"https://webpack.js.org/migrate/5/"},"Webpack 5")," (the version Gatsby 3 uses)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Run ",(0,r.kt)("inlineCode",{parentName:"p"},"npx gatsby clean")," to delete your projects development bundle")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Run ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn dev")))),(0,r.kt)("h2",null,"Troubleshooting"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Try deleting your node_modules, running ",(0,r.kt)("inlineCode",{parentName:"li"},"yarn cache clean")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"yarn install"),"\n(or ",(0,r.kt)("inlineCode",{parentName:"li"},"npm cache clean --force")," and npm install)"),(0,r.kt)("li",{parentName:"ul"},"Feel free to reach out in the #gatsby-theme-carbon slack channel or open an\nissue on GitHub")))}u.isMDXComponent=!0},4295:function(e,t,a){a.d(t,{Z:function(){return v}});var n=a(7294),r=a(8650),i=a.n(r),o=a(5444),l=a(9403),s=a(3321),m=a(5900),p=a.n(m);var c=e=>{let{title:t,theme:a,tabs:r=[]}=e;return n.createElement("div",{className:p()("PageHeader-module--page-header--NqfPe",{"PageHeader-module--with-tabs--vbQ-W":r.length,"PageHeader-module--dark-mode--WCeH8":"dark"===a})},n.createElement("div",{className:"bx--grid"},n.createElement("div",{className:"bx--row"},n.createElement("div",{className:"bx--col-lg-12"},n.createElement("h1",{id:"page-title",className:"PageHeader-module--text--Er2EO"},t)))))};var d=e=>{let{relativePagePath:t,repository:a}=e;const{site:{siteMetadata:{repository:r}}}=(0,o.useStaticQuery)("1364590287"),{baseUrl:i,subDirectory:l,branch:s}=a||r,m=i+"/edit/"+s+l+"/src/pages"+t;return i?n.createElement("div",{className:"bx--row EditLink-module--row--BEmSX"},n.createElement("div",{className:"bx--col"},n.createElement("a",{className:"EditLink-module--link--IDrl1",href:m},"Edit this page on GitHub"))):null},u=a(4275),h=a(1721);let g=function(e){function t(){return e.apply(this,arguments)||this}return(0,h.Z)(t,e),t.prototype.render=function(){const{title:e,tabs:t,slug:a}=this.props,r=a.split("/").filter(Boolean).slice(-1)[0],l=t.map((e=>{const t=i()(e,{lower:!0,strict:!0}),l=t===r,s=new RegExp(r+"/?(#.*)?$"),m=a.replace(s,t);return n.createElement("li",{key:e,className:p()({"PageTabs-module--selected-item--aBB0K":l},"PageTabs-module--list-item--024o6")},n.createElement(o.Link,{className:"PageTabs-module--link--Kz-7R",to:""+m},e))}));return n.createElement("div",{className:"PageTabs-module--tabs-container--Cdfzw"},n.createElement("div",{className:"bx--grid"},n.createElement("div",{className:"bx--row"},n.createElement("div",{className:"bx--col-lg-12 bx--col-no-gutter"},n.createElement("nav",{"aria-label":e},n.createElement("ul",{className:"PageTabs-module--list--xLqxG"},l))))))},t}(n.Component);var k=g,b=a(2881),N=a(6958),y=a(36);var f=e=>{let{date:t}=e;const a=new Date(t);return t?n.createElement(y.X2,{className:"last-modified-date-module--row--XJoYQ"},n.createElement(y.sg,null,n.createElement("div",{className:"last-modified-date-module--text--ogPQF"},"Page last updated: ",a.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null};var v=e=>{let{pageContext:t,children:a,location:r,Title:m}=e;const{frontmatter:p={},relativePagePath:h,titleType:g}=t,{tabs:y,title:v,theme:w,description:C,keywords:E,date:x}=p,{interiorTheme:P}=(0,N.Z)(),{site:{pathPrefix:T}}=(0,o.useStaticQuery)("2456312558"),j=T?r.pathname.replace(T,""):r.pathname,S=y?j.split("/").filter(Boolean).slice(-1)[0]||i()(y[0],{lower:!0}):"",M=w||P;return n.createElement(s.Z,{tabs:y,homepage:!1,theme:M,pageTitle:v,pageDescription:C,pageKeywords:E,titleType:g},n.createElement(c,{title:m?n.createElement(m,null):v,label:"label",tabs:y,theme:M}),y&&n.createElement(k,{title:v,slug:j,tabs:y,currentTab:S}),n.createElement(b.Z,{padded:!0},a,n.createElement(d,{relativePagePath:h}),n.createElement(f,{date:x})),n.createElement(u.Z,{pageContext:t,location:r,slug:j,tabs:y,currentTab:S}),n.createElement(l.Z,null))}}}]);
//# sourceMappingURL=component---src-pages-guides-v-2-migration-mdx-3c24032f547920a46aa1.js.map